<div class="card">
  <div class="card-header">
    <h2><%= @chapter.new_record? ? "Create a New Chapter" : "Edit Chapter" %></h2>
  </div>

  <div class="card-body">
    <%= form_with(model: [@book, @chapter], html: { class: "form" }) do |form| %>
      <div class="form-group">
        <%= form.label :title, class: "form-label" %>
        <%= form.text_field :title, class: "form-control" %>
      </div>

      <div class="form-group">
        <%= form.label :status, class: "form-label" %>
        <%= form.select :status, ['Draft', 'In Review', 'Published'], {}, class: "form-control" %>
      </div>

      <div class="form-group" data-controller="markdown-preview">
        <div class="markdown-editor-container">
          <div class="editor-pane">
            <%= form.label :content, class: "form-label" %>
            <%= form.text_area :content, 
                id: "editor",
                class: "form-control",
                data: { "markdown-preview-target": "source", action: "input->markdown-preview#update" } %>
          </div>
          <div class="preview-pane">
            <label class="form-label">Live Preview</label>
            <div data-markdown-preview-target="preview" class="chapter-content preview-content">
            </div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <%= form.label :notes, "Author's Notes", class: "form-label" %>
        <%= form.text_area :notes, class: "form-control", rows: 5 %>
      </div>

      <div class="form-actions">
        <%= render 'shared/button', text: (@chapter.new_record? ? "Create Chapter" : "Update Chapter") %>
        <%= render 'shared/button', text: 'Cancel', path: book_path(@book), variant: 'secondary' %>
      </div>
    <% end %>
  </div>
</div>


